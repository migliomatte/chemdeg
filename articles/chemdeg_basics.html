<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="chemdeg">
<title>chemdeg basics • chemdeg</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="chemdeg basics">
<meta property="og:description" content="chemdeg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">chemdeg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/chemdeg_basics.html">chemdeg basics</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/migliomatte/chemdeg/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>chemdeg basics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/migliomatte/chemdeg/blob/HEAD/vignettes/chemdeg_basics.Rmd" class="external-link"><code>vignettes/chemdeg_basics.Rmd</code></a></small>
      <div class="d-none name"><code>chemdeg_basics.Rmd</code></div>
    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      The present vignette provides basic information for the correct
      use of the package chemdeg, a package thought to support the
      analysis of chemical degradation kinetics experiments. The
      vignette is structured as follows: in the “Introduction” section
      the principles behind the mathematical approach will be explained;
      in “Package usage” section the main functions of the package are
      described and their outputs are shown; the “Examples” section
      shows the generic workflow of the program using data that have
      benn made available with the package and explains how to correctly
      use and interpret the results of the functions.
    </div>
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/migliomatte/chemdeg" class="external-link">chemdeg</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>A key aspect in food science is the prediction of the change of food
quality in time, and thus a quantitative analysis of the shelf life of
foods and of their components is of paramount importance.
<code>chemdeg</code> is a package developed to assist food chemists in
the objective selection of degradation kinetic models of foods and
parameters estimation. The software implements a two-step method to this
purpose. First, experimental data are analyzed in the so-called phase
space which allows for the estimation of the order of the reaction; then
the data are fitted with the appropriate standard kinetic model to
estimate the reaction rate. The whole procedure is driven by rigorous
statistical analyses of the results. The package also provides a routine
to fit a non-standard kinetic degradation model named first-order
multi-target model (FOMT).</p>
<p>The standard degradation kinetics of food and of their components are
described within the following differential equation which formalizes
the mass-action law: <span class="math display">\[\frac{d y}{d
t}=-k\,y^n \tag{1}
\]</span> where <span class="math inline">\(y\)</span> is the
concentration of the reactant (i.e. the concentration of the degrading
food molecule), <span class="math inline">\(t\)</span> is the time,
<span class="math inline">\(k\)</span> is the rate constant and <span class="math inline">\(n\)</span> is the order of reaction. The order
<span class="math inline">\(n\)</span> can assume either integer
(e.g. 0,1,2…) or fractional values as it may observed for complex
degradation reactions like overall multistage reaction composed by
single reactions with different reaction orders.</p>
<p>A logarithmic transformation of the eq.(1) yields: <span class="math display">\[ \log{|\frac{d y}{d
t}}|=\log{k}+n\,\log{y}\]</span> where <span class="math inline">\(\log{}\)</span> is the natural logarithm.</p>
<p>A plot of <span class="math inline">\(\log{|\frac{dy}{dt}|}\)</span>
versus <span class="math inline">\(\log{y}\)</span> defines the phase
space of the dynamical system, and standard n<sup>th</sup> reaction
order kinetic models are here represented as straight lines with slope
equal to <span class="math inline">\(n\)</span> and intercept equal to
the logarithm of <span class="math inline">\(k\)</span>. Derivatives are
calculated with the central finite difference method.</p>
<p>The slope can be easily determined by linear regression (weighted on
experimental error if available) of log-transformed data. Both known and
unknown uncertainties can affect this estimation. Thus a first decision
about the appropriate order of the reaction is taken by the program on
the basis of the following four criteria:</p>
<ol style="list-style-type: decimal">
<li>if the 95% confidence interval of <span class="math inline">\(n\)</span> includes one or more integer numbers,
then the best estimate of the reaction order is that integer number or
the integer which is closest to the mean estimate of <span class="math inline">\(n\)</span>;</li>
<li>if the 95% confidence interval of <span class="math inline">\(n\)</span> does not include integer numbers than
the order of the reaction is considered fractional and equal to its best
estimate;</li>
<li>if the estimated order <span class="math inline">\(n\)</span> is not
statistically significant but the intercept is significant, then the
most likely order of reaction is 0;</li>
<li>if neither the estimates of the slope and the intercept are
statistically significant then a different modeling approach must be
considered. The package provides a possible non-linear alternative model
(FOMT, see other model section)</li>
</ol>
<p>The general solution of eq.(1) is: <span class="math display">\[
y(t)=\begin{cases}
((n-1)\,k\,t+y_0^{1-n}))^{\frac{1}{n-1}} &amp; \text{if $n\ne 0$} \\
y_0\,e^{-k\,t} &amp; \text{if $n=0$}
\end{cases}
\]</span> Once the reaction order has been determined, non-linear least
squares regression can be performed using the above solution with the
rate constant <span class="math inline">\(k\)</span> as free
parameter.</p>
</div>
<div class="section level2">
<h2 id="package-usage">Package usage<a class="anchor" aria-label="anchor" href="#package-usage"></a>
</h2>
<p>The function <code><a href="../reference/det_order.html">det_order()</a></code> performs all in one the
analysis described in the <a href="#introduction">Introduction</a>
section. The input of the function must be an at least two-columns
data-frame with time data in the first column and concentration in the
second column. The values of experimental error can be given in the
optional third column. Different input types or data-frames with less
than two or more than 3 columns will return an error. The output of the
function is an <code>ord_res</code> class object.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ord1</span> <span class="co"># simulated data from a first order kinetic model with error</span></span>
<span><span class="co">#&gt;   t concentration   std.error</span></span>
<span><span class="co">#&gt; 1 0    14.3786746 0.077039565</span></span>
<span><span class="co">#&gt; 2 1     7.4582106 0.059189631</span></span>
<span><span class="co">#&gt; 3 2     3.7612821 0.129590803</span></span>
<span><span class="co">#&gt; 4 3     1.8158076 0.083778548</span></span>
<span><span class="co">#&gt; 5 4     0.9189166 0.005502180</span></span>
<span><span class="co">#&gt; 6 5     0.4479939 0.006840325</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/det_order.html">det_order</a></span><span class="op">(</span><span class="va">ord1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reaction order estimated: 1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ord_res"</span></span></code></pre></div>
<p>The function <code><a href="../reference/results.html">results()</a></code> shows a comprehensive summary of
the results. These include:</p>
<ol style="list-style-type: decimal">
<li>the results of linear regression performed in the phase space, the
estimate of <em>n</em> and its confidence interval;</li>
<li>a comment about the conclusion that can be drawn from the phase
space analysis;</li>
<li>the results of the regression performed on experimental data in the
conventional concentration vs. time space with the solution of eq.(1),
the estimate of the rate constant and its confidence interval;</li>
<li>goodness-of-fit statistics of the final fit (see next section)</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/results.html">results</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear regression in the phase space: </span></span>
<span><span class="co">#&gt; log(dx/dt)= 0.97 log(x) + ( -0.46 )</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimate of n:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Estimate   Std. Error      t value     Pr(&gt;|t|) </span></span>
<span><span class="co">#&gt; 9.701806e-01 4.235714e-03 2.290477e+02 1.835114e-07 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence interval of n: </span></span>
<span><span class="co">#&gt;     2.5 %    97.5 % </span></span>
<span><span class="co">#&gt; 0.9567007 0.9836605 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Statistical analysis indicates that an order 1 degradation kineitc model is likely to describe the data.</span></span>
<span><span class="co">#&gt; The null hypothesis H0:</span></span>
<span><span class="co">#&gt; "The process is described by an order 1kinetic model"</span></span>
<span><span class="co">#&gt;  cannot be rejected.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Non-linear least squares regression was performed with an order  1  kinetic model:</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  Estimate of k: </span></span>
<span><span class="co">#&gt;    Estimate  Std. Error  t value     Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; k 0.6878765 0.002626997 261.8489 1.541636e-11</span></span>
<span><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span><span class="co">#&gt; Confidence interval of k: </span></span>
<span><span class="co">#&gt;      2.5%     97.5% </span></span>
<span><span class="co">#&gt; 0.6812276 0.6947116 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Goodness-of-fit:</span></span>
<span><span class="co">#&gt;                  Value</span></span>
<span><span class="co">#&gt; AIC:        -11.933893</span></span>
<span><span class="co">#&gt; AICc:       -10.933893</span></span>
<span><span class="co">#&gt; BIC:        -12.350374</span></span>
<span><span class="co">#&gt; RMSE:         2.002812</span></span>
<span><span class="co">#&gt; Chi-sq_red:   5.379602</span></span>
<span><span class="co">#&gt; -----------------------------------------------------</span></span></code></pre></div>
<p>The function <code><a href="../reference/plot_ord.html">plot_ord()</a></code> allows the graphical
visualization of the results obtained with the whole analysis. Function
automatically plots the experimental error when provided. In these
plots, black lines show the best regression curve, whereas green lines
show the fits with the reaction order chosen according to the criteria
given in the previous section.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_ord.html">plot_ord</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p><img src="chemdeg_basics_files/figure-html/unnamed-chunk-4-1.png" width="700"><img src="chemdeg_basics_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
<p>The functions <code><a href="../reference/phase_space.html">phase_space()</a></code> and <code><a href="../reference/kin_regr.html">kin_regr()</a></code>
allow to retrieve the linear regression from the phase space and the
regression with the selected model, respectively:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linear_model_phase_space</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phase_space.html">phase_space</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="va">linear_model_phase_space</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = log_dx_dt ~ log_x, data = ldframe, weights = 1/ldframe$err_log^2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)        log_x  </span></span>
<span><span class="co">#&gt;     -0.4618       0.9702</span></span>
<span></span>
<span><span class="va">kinetic_regression</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kin_regr.html">kin_regr</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="va">kinetic_regression</span></span>
<span><span class="co">#&gt; Nonlinear regression model</span></span>
<span><span class="co">#&gt;   model: y ~ y0 * exp(-k * t)</span></span>
<span><span class="co">#&gt;    data: list(t = dframe[[1]], y = dframe[[2]], y0 = y0, err = err)</span></span>
<span><span class="co">#&gt;      k </span></span>
<span><span class="co">#&gt; 0.6879 </span></span>
<span><span class="co">#&gt;  weighted residual sum-of-squares: 20.06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of iterations to convergence: 3 </span></span>
<span><span class="co">#&gt; Achieved convergence tolerance: 4.421e-08</span></span></code></pre></div>
<div class="section level3">
<h3 id="goodness-of-fit-measures">Goodness-of-fit measures<a class="anchor" aria-label="anchor" href="#goodness-of-fit-measures"></a>
</h3>
<p>Goodness-of-fit statistics include functions that are already
accessible in the package <code>stats</code>, like: Bayesian Information
Criterion (<code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">stats::BIC()</a></code>), Akaike’s Information Criterion
(<code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">stats::AIC()</a></code>) and Root Mean Square Error
(<code><a href="https://rdrr.io/r/stats/sigma.html" class="external-link">stats::sigma()</a></code>).</p>
<p>In the package <code>chemdeg</code> two more measures are introduced,
which are the reduced chi-squared (<span class="math inline">\(\chi^2_{red}=\chi^2/df\)</span>, where <span class="math inline">\(df\)</span> are the degrees of freedom) and the
Akaike’s Information Criterion AICc corrected for finite samples. The
values of both statistics are accessible with the functions
<code><a href="../reference/chiquad_red.html">chiquad_red()</a></code> and <code><a href="../reference/AICC.html">AICC()</a></code>, respectively.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/chiquad_red.html">chiquad_red</a></span><span class="op">(</span><span class="va">kinetic_regression</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.379602</span></span>
<span><span class="fu"><a href="../reference/AICC.html">AICC</a></span><span class="op">(</span><span class="va">kinetic_regression</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -10.93389</span></span></code></pre></div>
<p>The whole statistics can be accessed through the
<code><a href="../reference/goodness_of_fit.html">goodness_of_fit()</a></code>function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/goodness_of_fit.html">goodness_of_fit</a></span><span class="op">(</span><span class="va">kinetic_regression</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  Value</span></span>
<span><span class="co">#&gt; AIC:        -11.933893</span></span>
<span><span class="co">#&gt; AICc:       -10.933893</span></span>
<span><span class="co">#&gt; BIC:        -12.350374</span></span>
<span><span class="co">#&gt; RMSE:         2.002812</span></span>
<span><span class="co">#&gt; Chi-sq_red:   5.379602</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-functions">Other functions<a class="anchor" aria-label="anchor" href="#other-functions"></a>
</h3>
<p>To generate a <code>formula</code> object containing the formula of
an <em>n<sup>th</sup></em> kinetic reaction model, the function
<code>f_gen(n)</code> can be called, by giving <em>n</em> as input.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/f_gen.html">f_gen</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; y ~ y0 * exp(-k * t)</span></span>
<span><span class="co">#&gt; &lt;environment: 0x559d115ddad0&gt;</span></span>
<span></span>
<span><span class="fu"><a href="../reference/f_gen.html">f_gen</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; y ~ (1 * (k * t + (y0^(-1))/1))^-1</span></span>
<span><span class="co">#&gt; &lt;environment: 0x559d1164d090&gt;</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-models">Other Models<a class="anchor" aria-label="anchor" href="#other-models"></a>
</h3>
<div class="section level4">
<h4 id="first-order-multi-target-model-fomt">First-Order Multi-Target model (FOMT)<a class="anchor" aria-label="anchor" href="#first-order-multi-target-model-fomt"></a>
</h4>
<p>The FOMT model is equivalent to the Single-Hit Multi-Target model
(SHMT), a model developed in the field of radiation biology to describe
the fraction of cell surviving radiation treatments. In radio-biology
the problem is to calculate the probability of cell survival to a dose D
of radiation whereas in the present context the probability that
molecules survive within a given time interval. In both cases, the
assumption is that the events that hit a cell or, as in this case, a
food sample are random and they occur at a constant mean rate <span class="math inline">\(k\)</span> and independently of the time since the
last event (the hits, therefore, follow the Poisson distribution). If a
sample is composed of sub-units and at least <em>m</em> of them must be
inactivated by at least one hit, the overall survival probability is
given by the equation:</p>
<p><span class="math display">\[\frac{Y(t)}{Y_0}=1-(1-e^{-k\,t})^n
\]</span> More information on model development can be found in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3823792/" class="external-link">this
work</a>.</p>
<p>In <code>chemdeg</code> the FOMT model can be fitted by calling
<code><a href="../reference/FOMT.html">FOMT()</a></code> function, giving as input a data-frame with time,
concentration and error (optional) in the first three columns.</p>
<p>The output is an <code>nls</code> class object and thus all the
functions from package <code>stats</code> can be used to retrieve
regression information. Even in this case the goodness-of-fit can be
accessed through the <code><a href="../reference/goodness_of_fit.html">goodness_of_fit()</a></code> function.</p>
<p>The non-linear fit with the FOMT model is quite sensitive to the
initial value of the parameters and this is particularly true for the
exponent <em>m</em>. The <code><a href="../reference/FOMT.html">FOMT()</a></code> function implements a
routine for the automatic selection of the approximate initial values of
model parameters which is based on the analysis of actual experimental
data (see <code><a href="../reference/par_est_FOMT.html">par_est_FOMT()</a></code>). However, if <code><a href="../reference/FOMT.html">FOMT()</a></code>
fails to converge, it is possible to input manually the initial
parameter values using the function <code><a href="../reference/FOMTm.html">FOMTm()</a></code> as RHS of the
formula in the <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls()</a></code> function:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  conc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.99</span>, <span class="fl">0.98</span>, <span class="fl">0.5</span>, <span class="fl">0.24</span>, <span class="fl">0.12</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/FOMT.html">FOMT</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in numericDeriv(form[[3L]], names(ind), env, central = nDcentral) : </span></span>
<span><span class="co">#&gt;   Missing value or an infinity produced when evaluating the model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a></span><span class="op">(</span><span class="va">conc</span> <span class="op">~</span> <span class="fu"><a href="../reference/FOMTm.html">FOMTm</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">k</span>, <span class="va">n</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    conc <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">conc</span>,</span>
<span>    time <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">time</span></span>
<span>  <span class="op">)</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Nonlinear regression model</span></span>
<span><span class="co">#&gt;   model: conc ~ FOMTm(time, k, n)</span></span>
<span><span class="co">#&gt;    data: list(conc = dat$conc, time = dat$time)</span></span>
<span><span class="co">#&gt;      k      n </span></span>
<span><span class="co">#&gt;  1.147 24.433 </span></span>
<span><span class="co">#&gt;  residual sum-of-squares: 0.00772</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of iterations to convergence: 8 </span></span>
<span><span class="co">#&gt; Achieved convergence tolerance: 6.697e-06</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="generic-workflow">Generic workflow<a class="anchor" aria-label="anchor" href="#generic-workflow"></a>
</h3>
<p><code>chemdeg</code> package contains some simulated and actual
experimental data that can be used for training purposes.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">urfa</span></span>
<span><span class="co">#&gt;    time_min AA_55 AA_65 AA_75</span></span>
<span><span class="co">#&gt; 1         0  1.00  1.00  1.00</span></span>
<span><span class="co">#&gt; 2        60  0.69  0.56  0.39</span></span>
<span><span class="co">#&gt; 3       120  0.51  0.45  0.23</span></span>
<span><span class="co">#&gt; 4       180  0.43  0.37  0.19</span></span>
<span><span class="co">#&gt; 5       240  0.37  0.29  0.17</span></span>
<span><span class="co">#&gt; 6       300  0.31  0.25  0.14</span></span>
<span><span class="co">#&gt; 7       360  0.24  0.21  0.11</span></span>
<span><span class="co">#&gt; 8       480  0.20  0.16  0.09</span></span>
<span><span class="co">#&gt; 9       720  0.17  0.12  0.08</span></span>
<span><span class="co">#&gt; 10      840  0.16  0.10  0.08</span></span>
<span><span class="co">#&gt; 11      960  0.15  0.10  0.07</span></span></code></pre></div>
<p>The <code>urfa</code> data concern the normalized degradation
kinetics of ascorbic acid in Urfa peppers dehydrated with hot air at 55,
65 and 75°C (Dağhan et al., 2018). <code>urfa</code> returns a
data-frame with 4 columns. The first is time and the following are the
degradation data measured at different temperatures. Data in this format
are not readable from the <code><a href="../reference/det_order.html">det_order()</a></code> function (see <a href="#package-usage">Package usage</a>):</p>
<p>The data-frame must be transformed into a data-frame with two columns
(or three if the experimental error is available), the first containing
the time data and the second the measured concentration of the compound
(note that the data must not be necessarily normalized with respect to
the concentration of the molecule at time 0):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/det_order.html">det_order</a></span><span class="op">(</span><span class="va">urfa</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in det_order(urfa) : </span></span>
<span><span class="co">#&gt;   Error: the number of columns provided does not match the</span></span>
<span><span class="co">#&gt;              requirements. Only dataframe with 2 columns (time,data)</span></span>
<span><span class="co">#&gt;              and 3 columns (time,data,error) are accepted</span></span>
<span></span>
<span><span class="va">urfa1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">urfa</span><span class="op">$</span><span class="va">time_min</span>, <span class="va">urfa</span><span class="op">$</span><span class="va">AA_55</span><span class="op">)</span></span>
<span><span class="va">ord.urfa.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/det_order.html">det_order</a></span><span class="op">(</span><span class="va">urfa1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reaction order estimated: 2</span></span></code></pre></div>
<p>The function returns a message which informs the user about the best
ordinary model that can explain the data, an order 2 degradation kinetic
model in this case. the function <code><a href="../reference/results.html">results()</a></code> provides more
information:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/results.html">results</a></span><span class="op">(</span><span class="va">ord.urfa.1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear regression in the phase space: </span></span>
<span><span class="co">#&gt; log(dx/dt)= 2.45 log(x) + ( -4.56 )</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimate of n:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Estimate   Std. Error      t value     Pr(&gt;|t|) </span></span>
<span><span class="co">#&gt; 2.454865e+00 2.571281e-01 9.547245e+00 1.198314e-05 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence interval of n: </span></span>
<span><span class="co">#&gt;    2.5 %   97.5 % </span></span>
<span><span class="co">#&gt; 1.861927 3.047804 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Statistical analysis indicates that an order 2 degradation kineitc model is likely to describe the data.</span></span>
<span><span class="co">#&gt; The null hypothesis H0:</span></span>
<span><span class="co">#&gt; "The process is described by an order 2kinetic model"</span></span>
<span><span class="co">#&gt;  cannot be rejected.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Non-linear least squares regression was performed with an order  2  kinetic model:</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  Estimate of k: </span></span>
<span><span class="co">#&gt;      Estimate   Std. Error  t value     Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; k 0.007517079 0.0002185557 34.39434 1.022054e-11</span></span>
<span><span class="co">#&gt; Waiting for profiling to be done...</span></span>
<span><span class="co">#&gt; Confidence interval of k: </span></span>
<span><span class="co">#&gt;        2.5%       97.5% </span></span>
<span><span class="co">#&gt; 0.007047215 0.008026010 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Goodness-of-fit:</span></span>
<span><span class="co">#&gt;                   Value</span></span>
<span><span class="co">#&gt; AIC:        -54.4227221</span></span>
<span><span class="co">#&gt; AICc:       -53.9782777</span></span>
<span><span class="co">#&gt; BIC:        -53.6269316</span></span>
<span><span class="co">#&gt; RMSE:         0.0178302</span></span>
<span><span class="co">#&gt; Chi-sq_red:          NA</span></span>
<span><span class="co">#&gt; NB: Reduced Chi-squared is not calculated with unweighted data</span></span>
<span><span class="co">#&gt; -----------------------------------------------------</span></span></code></pre></div>
<p>first it returns the estimate of the order <em>n</em> along with its
confidence interval. We remind that the algorithm automatically chooses
the integer value (if present within the confidence interval) that is
the nearest to the estimate of <em>n</em>. For example, if the estimate
is 1.6 and the CI is 0.8-2.4, the value taken would be 2. This might
nonetheless be not the right value. For example the scientific
literature or any precious information might suggest that a reaction
model of order equal to 1 (which is inside the CI) could explain the
data. In this case both alternative models should be used to fit the
data and the results compared. The <code><a href="../reference/results.html">results()</a></code> function,
however, returns an explanation why a certain value of <em>n</em> was
chosen.</p>
<p>Once the order of reaction is estimated to be 2 non-linear regression
of the data with the appropriate model is performed and the estimated
value of the rate constant is <em>k</em> and of its confidence interval
is given. Finally, goodness-of-fit statistics are showed for non-linear
regressions (note that this holds for reaction orders <span class="math inline">\(\ne 0\)</span>).</p>
<p>A call to the function <code><a href="../reference/plot_ord.html">plot_ord()</a></code> allows to visualize
the results:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_ord.html">plot_ord</a></span><span class="op">(</span><span class="va">ord.urfa.1</span><span class="op">)</span></span></code></pre></div>
<p><img src="chemdeg_basics_files/figure-html/unnamed-chunk-13-1.png" width="700"><img src="chemdeg_basics_files/figure-html/unnamed-chunk-13-2.png" width="700"></p>
<p>the plot on the left side represents the phase space of the system.
On the right side, the kinetic data are plotted together with the
model’s regression curve.</p>
<p>The results show that a 2nd-order degradation model best explains the
data. The following example, however, shows that it is not always
possible to proceed straightforwardly as in the present case and that
caution is recommended before drawing conclusions about the appropriate
degradation kinetic model that best fit experimental data.</p>
</div>
<div class="section level3">
<h3 id="fomt-example">FOMT example<a class="anchor" aria-label="anchor" href="#fomt-example"></a>
</h3>
<p>In this case we load data <code>fomtdata</code> from the package,
that concerns the degradation kinetics of a 1.2 mM solution of
5-caffeoylquinic acid (5-CQA) in the presence of 1.2 mM ascorbic acid
(Yusaku and Kuniyo, 2013).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fomtdata</span></span>
<span><span class="co">#&gt;   time_h tCQA_AA</span></span>
<span><span class="co">#&gt; 1      0   1.000</span></span>
<span><span class="co">#&gt; 2      5   0.997</span></span>
<span><span class="co">#&gt; 3     24   0.994</span></span>
<span><span class="co">#&gt; 4     48   0.424</span></span>
<span><span class="co">#&gt; 5     72   0.190</span></span>
<span><span class="co">#&gt; 6     96   0.072</span></span>
<span><span class="co">#&gt; 7    144   0.053</span></span>
<span><span class="co">#&gt; 8    168   0.001</span></span></code></pre></div>
<p>In this case the data are ready to be passed to the
<code><a href="../reference/det_order.html">det_order()</a></code> function:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ord.cqa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/det_order.html">det_order</a></span><span class="op">(</span><span class="va">fomtdata</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reaction order estimated: 0</span></span></code></pre></div>
<p>Indeed, the results are:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/results.html">results</a></span><span class="op">(</span><span class="va">ord.cqa</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear regression in the phase space: </span></span>
<span><span class="co">#&gt; log(dx/dt)= -0.07 log(x) + ( -6.35 )</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimate of n:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    Estimate  Std. Error     t value    Pr(&gt;|t|) </span></span>
<span><span class="co">#&gt; -0.06502888  0.57024177 -0.11403739  0.91364577 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence interval of n: </span></span>
<span><span class="co">#&gt;     2.5 %    97.5 % </span></span>
<span><span class="co">#&gt; -1.530882  1.400824 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimate of the intercept is significant; but the estimate of slope is not.</span></span>
<span><span class="co">#&gt; The data are likely to be described by an 0-order kinetic model.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear  regression was performed (0-order kinetics).</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt; Estimated k value: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = y ~ t, data = list(t = dframe[[1]], y = dframe[[2]]))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.26063 -0.19418  0.07587  0.12336  0.22518 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  0.927907   0.113881   8.148 0.000184 ***</span></span>
<span><span class="co">#&gt; t           -0.006629   0.001251  -5.298 0.001834 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.2074 on 6 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.8239, Adjusted R-squared:  0.7945 </span></span>
<span><span class="co">#&gt; F-statistic: 28.06 on 1 and 6 DF,  p-value: 0.001834</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence interval of k: </span></span>
<span><span class="co">#&gt;       2.5 %      97.5 % </span></span>
<span><span class="co">#&gt; 0.009690610 0.003567045 </span></span>
<span><span class="co">#&gt; -----------------------------------------------------</span></span></code></pre></div>
<p>In this case the software suggests that a 0-order model might
actually fit the data. However a plot of the results indicates that a
0-order model is actually not suitable to explain the experimental
data:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_ord.html">plot_ord</a></span><span class="op">(</span><span class="va">ord.cqa</span><span class="op">)</span></span></code></pre></div>
<p><img src="chemdeg_basics_files/figure-html/unnamed-chunk-17-1.png" width="700"><img src="chemdeg_basics_files/figure-html/unnamed-chunk-17-2.png" width="700">
Please remind that the <code><a href="../reference/kin_regr.html">kin_regr()</a></code> function returns the
kinetic regression on kinetic data. Information can be retrieved to
eventually check if the regression is indeed reliable:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kin_regr.html">kin_regr</a></span><span class="op">(</span><span class="va">ord.cqa</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lin</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = y ~ t, data = list(t = dframe[[1]], y = dframe[[2]]))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.26063 -0.19418  0.07587  0.12336  0.22518 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  0.927907   0.113881   8.148 0.000184 ***</span></span>
<span><span class="co">#&gt; t           -0.006629   0.001251  -5.298 0.001834 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.2074 on 6 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.8239, Adjusted R-squared:  0.7945 </span></span>
<span><span class="co">#&gt; F-statistic: 28.06 on 1 and 6 DF,  p-value: 0.001834</span></span></code></pre></div>
<p>However, the data in the previous plot show a time-dependent trend
that is reminiscent of the graph of the nonlinear FOMT function. The
function<code><a href="../reference/FOMT.html">FOMT()</a></code> permits to fit the data with the same name
model:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/FOMT.html">FOMT</a></span><span class="op">(</span><span class="va">fomtdata</span><span class="op">)</span></span>
<span><span class="co">#&gt; Nonlinear regression model</span></span>
<span><span class="co">#&gt;   model: y ~ 1 - (1 - exp(-k * t))^n</span></span>
<span><span class="co">#&gt;    data: list(y = y, t = t)</span></span>
<span><span class="co">#&gt;       k       n </span></span>
<span><span class="co">#&gt; 0.05684 9.47817 </span></span>
<span><span class="co">#&gt;  residual sum-of-squares: 0.0108</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of iterations to convergence: 10 </span></span>
<span><span class="co">#&gt; Achieved convergence tolerance: 4.075e-06</span></span></code></pre></div>
<p>It is possible that the function <code><a href="../reference/FOMT.html">FOMT()</a></code> could not be
able to converge. This is because initial parameter values automatically
chosen by the program are not close enough to the <em>true</em> ones
(for more information see <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls()</a></code> from package
<code>stats</code>). To perform the non-linear regression a manual input
of the initial parameter value is required using the
function<code><a href="../reference/FOMTm.html">FOMTm()</a></code> as RHS of the formula:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regr.FOMT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html" class="external-link">nls</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="../reference/FOMTm.html">FOMTm</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">k</span>, <span class="va">n</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">fomtdata</span><span class="op">$</span><span class="va">tCQA_AA</span>, t <span class="op">=</span> <span class="va">fomtdata</span><span class="op">$</span><span class="va">time_h</span><span class="op">)</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, k <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">regr.FOMT</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula: y ~ FOMTm(t, k, n)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameters:</span></span>
<span><span class="co">#&gt;   Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; n 9.478164   3.926142   2.414 0.052280 .  </span></span>
<span><span class="co">#&gt; k 0.056836   0.008206   6.926 0.000449 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.04243 on 6 degrees of freedom</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of iterations to convergence: 9 </span></span>
<span><span class="co">#&gt; Achieved convergence tolerance: 5.306e-06</span></span></code></pre></div>
<p>The following plot compares the results from both linear (in red
color) and non-linear regression analysis of the experimental data:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fomtdata</span><span class="op">$</span><span class="va">time_h</span>, <span class="va">fomtdata</span><span class="op">$</span><span class="va">tCQA_AA</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"time (h)"</span>, ylab <span class="op">=</span> <span class="st">"C/C0"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">new_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">fomtdata</span><span class="op">$</span><span class="va">time_h</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">new_t</span>, <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">regr.FOMT</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">new_t</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">fomtdata</span><span class="op">$</span><span class="va">time_h</span>, <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">lin</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="chemdeg_basics_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p>The FOMT model fits the data much better than the linear model.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/goodness_of_fit.html">goodness_of_fit</a></span><span class="op">(</span><span class="va">regr.FOMT</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    Value</span></span>
<span><span class="co">#&gt; AIC:        -24.15681095</span></span>
<span><span class="co">#&gt; AICc:       -21.75681095</span></span>
<span><span class="co">#&gt; BIC:        -23.91848633</span></span>
<span><span class="co">#&gt; RMSE:         0.04243006</span></span>
<span><span class="co">#&gt; Chi-sq_red:           NA</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matteo Migliorini, Roberto Chignola.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
