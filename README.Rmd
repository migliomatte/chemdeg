---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# chemdeg

<!-- badges: start -->
<!-- badges: end -->

The goal of chemdeg is to assist chemical degradation kinetic data analysis. It provides a rigorous statistical method for the determination of the reaction order for n^th^-order kinetic models, which is often prone to subjectivity.
The first-order multi-target model (FOMT) is introduced as a genuine alternative to Weibull distribution.
In addition, some goodness-of-fit statistics have been added for nonlinear models. 

## Installation

You can install the development version of chemdeg like so:

``` r
# from CRAN
install.packages("chemdeg")

# from GitHub
devtools::install_github("migliomatte/chemdeg")
```

## Usage

```{r example}
library(chemdeg)
```

#### Determination of the reaction order
The determination of the reaction order of a generic degradation kinetic model is often prone to subjectivity and can be misleading. By analyzing the phase space of the dynamical system it is possible to rigorously determine the reaction order thought statistics. In the package `chemdeg` this analysis can be performed with the function `det_order()`:

```{r}
res <- det_order(ord1)
```

where `ord1` is built in the package data-frame from a 1^st^-order kinetic model. 

The summary of the results can be accessed with the function results:
```{r}
results(res)
```

and the plot of both the phase space and the kinetic degradation data with relative regressions can be accessed with `plot_ord()`:
```{r}
plot_ord(res)
```
#### First-order multi-target model fitting
To fit the first-order multi-target model, use the function `FOMT()`. 
```{r}
fit_fomt<-FOMT(fomtdata)
summary(fit_fomt)
```
where `fomtdata` is an example data-frame provided with the package.

Alternatively, if the function does not converge the function `nls` from package stats with the function `FOMTm()` as RHS of the formula and initial values inserted arbitrarily:
```{r}
fit_fomt1<-nls(y ~ FOMTm(t, k, n),
               data = list(y = fomtdata$tCQA_AA, t = fomtdata$time_h),
               start = list(n = 10, k = 0.05))
summary(fit_fomt1)

```

#### Goodness-of-fit statistics
`chemdeg` implements the chi-squared reduced ($\chi^2_{red}=\chi^2/df$ where $df$ are the degrees of freedom) and Akaike Information Criterion with correction for small sample size (AICc) as goodness of fit measures. Those measures can be accessed with the functions `chiquad_red()`and `AICC()`,respectively.

To access a table with Bayesian Information Criterion (BIC), Akaike Information Criterion (AIC), AICc, Root Means Squared Error (RMSE) and $\chi^2_{red}$ (from both package `stats` and `chemdeg`) call the function  `goodness_of_fit()`:
```{r}
goodness_of_fit(fit_fomt)
```

For more details see the vignette [chemdeg basics](articles/chemdeg_basics.html).
